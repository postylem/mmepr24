var jsPsychCloze=function(r){"use strict";var m={name:"@jspsych/plugin-cloze",version:"2.0.0",description:"jsPsych plugin for displaying a cloze test and checking participants answers against a correct solution",type:"module",main:"dist/index.cjs",exports:{import:"./dist/index.js",require:"./dist/index.cjs"},typings:"dist/index.d.ts",unpkg:"dist/index.browser.min.js",files:["src","dist"],source:"src/index.ts",scripts:{test:"jest","test:watch":"npm test -- --watch",tsc:"tsc",build:"rollup --config","build:watch":"npm run build -- --watch"},repository:{type:"git",url:"git+https://github.com/jspsych/jsPsych.git",directory:"packages/plugin-cloze"},author:"Philipp Sprengholz",license:"MIT",bugs:{url:"https://github.com/jspsych/jsPsych/issues"},homepage:"https://www.jspsych.org/latest/plugins/cloze",peerDependencies:{jspsych:">=7.1.0"},devDependencies:{"@jspsych/config":"^3.0.0","@jspsych/test-utils":"^1.2.0"}};const g={name:"cloze",version:m.version,parameters:{text:{type:r.ParameterType.HTML_STRING,default:void 0},button_text:{type:r.ParameterType.STRING,default:"OK"},check_answers:{type:r.ParameterType.BOOL,default:!1},allow_blanks:{type:r.ParameterType.BOOL,default:!0},mistake_fn:{type:r.ParameterType.FUNCTION,default:()=>{}}},data:{response:{type:r.ParameterType.STRING,array:!0}}};class h{constructor(e){this.jsPsych=e}trial(e,t){var i='<div class="cloze">',s=t.text.split("%");const n=this.getSolutions(t.text);let o=0;for(var a=0;a<s.length;a++)a%2===0?i+=s[a]:(i+=`<input type="text" id="input${o}" value="">`,o++);i+="</div>",e.innerHTML=i;const l=()=>{for(var u=[],d=!0,y=!0,c=0;c<n.length;c++){var p=document.getElementById("input"+c);u.push(p.value.trim()),t.check_answers&&(u[c]!==n[c]?(p.style.color="red",d=!1):p.style.color="black"),t.allow_blanks||u[c]===""&&(y=!1)}if(t.check_answers&&!d||!t.allow_blanks&&!y)t.mistake_fn();else{var _={response:u};this.jsPsych.finishTrial(_)}};e.innerHTML+='<br><button class="jspsych-html-button-response-button" type="button" id="finish_cloze_button">'+t.button_text+"</button>",e.querySelector("#finish_cloze_button").addEventListener("click",l)}getSolutions(e){const t=[],i=e.split("%");for(let s=0;s<i.length;s++)s%2==1&&t.push(i[s].trim());return t}simulate(e,t,i,s){t=="data-only"&&(s(),this.simulate_data_only(e,i)),t=="visual"&&this.simulate_visual(e,i,s)}create_simulation_data(e,t){const i=this.getSolutions(e.text),s=[];for(const o of i)o==""?s.push(this.jsPsych.randomization.randomWords({exactly:1})):s.push(o);const n={response:s};return this.jsPsych.pluginAPI.mergeSimulationData(n,t)}simulate_data_only(e,t){const i=this.create_simulation_data(e,t);this.jsPsych.finishTrial(i)}simulate_visual(e,t,i){const s=this.create_simulation_data(e,t),n=this.jsPsych.getDisplayElement();this.trial(n,e),i();const o=n.querySelectorAll('input[type="text"]');let a=this.jsPsych.randomization.sampleExGaussian(750,200,.01,!0);for(let l=0;l<s.response.length;l++)this.jsPsych.pluginAPI.fillTextInput(o[l],s.response[l],a),a+=this.jsPsych.randomization.sampleExGaussian(750,200,.01,!0);this.jsPsych.pluginAPI.clickTarget(n.querySelector("#finish_cloze_button"),a)}}return h.info=g,h}(jsPsychModule);
//# sourceMappingURL=https://unpkg.com/@jspsych/plugin-cloze@2.0.0/dist/index.browser.min.js.map
